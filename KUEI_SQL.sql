DROP TABLE RESREC;
DROP TABLE HSECOLL;
DROP TABLE BREAKTIME;
DROP TABLE MRMSG;
DROP TABLE MSMSG;

DROP SEQUENCE RESR_SEQ;

-----預約看屋紀錄-----
CREATE TABLE RESREC (
 RESR_NO             VARCHAR2(15) PRIMARY KEY NOT NULL,
 MEM_NO              VARCHAR2(10) NOT NULL,
 HOUSE_NO            VARCHAR2(100) NOT NULL,
 RTR_NO              VARCHAR2(10) NOT NULL,
 RESR_ORD            TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
 RESR_STATES         VARCHAR2(15) NOT NULL,
 RESR_DATE           DATE,
 RESR_PERIOD         VARCHAR2(12),
 HSE_EVAL            CLOB,
 HSE_REV             CLOB,
 MEM_RATE            NUMBER(2),
 MEM_REV             VARCHAR2(300),
 RTR_RATE            NUMBER(2),
 CONSTRAINT FK_RRHNO FOREIGN KEY (HOUSE_NO) REFERENCES HOUSEINFO(HOUSE_NO),
 CONSTRAINT FK_RRRNO FOREIGN KEY (RTR_NO) REFERENCES REALTOR(RTR_NO),
 CONSTRAINT FK_RRMNO FOREIGN KEY (MEM_NO) REFERENCES MEMBER(MEM_NO)
 );


CREATE SEQUENCE RESR_SEQ;

INSERT INTO RESREC (RESR_NO, MEM_NO, HOUSE_NO, RTR_NO, RESR_STATES, RESR_DATE, RESR_PERIOD)VALUES ('RR'||TO_CHAR(SYSDATE,'RRMMDD')||'-'||(LPAD(to_char(RESR_SEQ.NEXTVAL),5,'0')),'MB00000003','HSE00000001','RT00000004','ESTABLISH',TO_DATE('2017/10/28','YYYY/MM/DD'),'10:00-12:00');
INSERT INTO RESREC (RESR_NO, MEM_NO, HOUSE_NO, RTR_NO, RESR_STATES, RESR_DATE, RESR_PERIOD)VALUES ('RR'||TO_CHAR(SYSDATE,'RRMMDD')||'-'||(LPAD(to_char(RESR_SEQ.NEXTVAL),5,'0')),'MB00000002','HSE00000002','RT00000009','ESTABLISH',TO_DATE('2017/10/30','YYYY/MM/DD'),'12:00-14:00');
INSERT INTO RESREC (RESR_NO, MEM_NO, HOUSE_NO, RTR_NO, RESR_STATES, RESR_DATE, RESR_PERIOD)VALUES ('RR'||TO_CHAR(SYSDATE,'RRMMDD')||'-'||(LPAD(to_char(RESR_SEQ.NEXTVAL),5,'0')),'MB00000001','HSE00000003','RT00000010','ESTABLISH',TO_DATE('2017/10/29','YYYY/MM/DD'),'14:00-16:00');
INSERT INTO RESREC (RESR_NO, MEM_NO, HOUSE_NO, RTR_NO, RESR_STATES, RESR_DATE, RESR_PERIOD)VALUES ('RR'||TO_CHAR(SYSDATE,'RRMMDD')||'-'||(LPAD(to_char(RESR_SEQ.NEXTVAL),5,'0')),'MB00000004','HSE00000002','RT00000002','ESTABLISH',TO_DATE('2017/11/01','YYYY/MM/DD'),'18:00-20:00');
UPDATE RESREC set RESR_STATES='CONFIRM',HSE_EVAL='{ "地段":"5", "屋齡":"3", "價格":"2" }',HSE_REV='價格有點小貴，屋齡尚可接受，結論:我覺得可以',MEM_RATE='4',MEM_REV='THIS REALTOR IS GOOD.',RTR_RATE='5' where RESR_NO = 'RR171030-00001';
UPDATE RESREC set RESR_STATES='CONFIRM',HSE_EVAL='{ "地段":"3", "屋齡":"2", "價格":"1" }',HSE_REV='超級雷，這什麼房子阿，沒想到房子也有照騙阿，超級失望又浪費時間',MEM_RATE='4',MEM_REV='雖然房子雷，但這房仲不錯，找房可以找他',RTR_RATE='5' where RESR_NO = 'RR171030-00004';
UPDATE RESREC set RESR_STATES='CANCEL' where RESR_NO = 'RR171030-00003';
COMMIT;

-----收藏房屋-----
CREATE TABLE HSECOLL (
 MEM_NO VARCHAR2(10) NOT NULL,
 HOUSE_NO VARCHAR2(100) NOT NULL, 
 CONSTRAINT PK_HSECOLL PRIMARY KEY (HOUSE_NO,MEM_NO),
 CONSTRAINT FK_HSEHNO FOREIGN KEY (HOUSE_NO) REFERENCES HOUSEINFO(HOUSE_NO),
 CONSTRAINT FK_HSEMNO FOREIGN KEY (MEM_NO) REFERENCES MEMBER(MEM_NO)
);

INSERT INTO HSECOLL VALUES('MB00000003','HSE00000001');
INSERT INTO HSECOLL VALUES('MB00000004','HSE00000001');
INSERT INTO HSECOLL VALUES('MB00000002','HSE00000001');
INSERT INTO HSECOLL VALUES('MB00000002','HSE00000002');
INSERT INTO HSECOLL VALUES('MB00000002','HSE00000003');
INSERT INTO HSECOLL VALUES('MB00000001','HSE00000002');
INSERT INTO HSECOLL VALUES('MB00000001','HSE00000003');

COMMIT;


-----休息時間-----
CREATE TABLE BREAKTIME(
 RTR_NO VARCHAR2(10) NOT NULL,
 BRK_DATE DATE NOT NULL,
 BRK_PERIOD VARCHAR2(12) NOT NULL,
 CONSTRAINT FK_BTRNO FOREIGN KEY (RTR_NO) REFERENCES REALTOR (RTR_NO),
 CONSTRAINT PK_BT PRIMARY KEY (RTR_NO,BRK_DATE,BRK_PERIOD)
);

INSERT INTO BREAKTIME VALUES('RT00000005',TO_DATE('2017-11-04','YYYY/MM/DD'),'10:00-13:00');
INSERT INTO BREAKTIME VALUES('RT00000005',TO_DATE('2017-11-04','YYYY/MM/DD'),'14:00-18:00');
INSERT INTO BREAKTIME VALUES('RT00000007',TO_DATE('2017-11-02','YYYY/MM/DD'),'10:00-13:00');
INSERT INTO BREAKTIME VALUES('RT00000012',TO_DATE('2017-11-02','YYYY/MM/DD'),'10:00-13:00');
INSERT INTO BREAKTIME VALUES('RT00000010',TO_DATE('2017-11-03','YYYY/MM/DD'),'12:00-15:00');
INSERT INTO BREAKTIME VALUES('RT00000010',TO_DATE('2017-11-05','YYYY/MM/DD'),'12:00-15:00');
COMMIT;


-----房仲即時訊息-----
CREATE TABLE MRMSG(
 MEM_NO VARCHAR2(10) NOT NULL,
 RTR_NO VARCHAR2(10) NOT NULL,
 MR_MSG CLOB,
 MR_TIME TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
 CONSTRAINT FK_MRMNO FOREIGN KEY (MEM_NO) REFERENCES MEMBER (MEM_NO),
 CONSTRAINT FK_MRRNO FOREIGN KEY (RTR_NO) REFERENCES REALTOR (RTR_NO),
 CONSTRAINT PK_MRMSG PRIMARY KEY (MEM_NO,RTR_NO)
);

INSERT INTO MRMSG(MEM_NO,RTR_NO,MR_MSG) VALUES ('MB00000004','RT00000010','比爾蓋茲:這間房子好像還不錯，請問房仲你可以帶我去看一下嗎?
陳金鋒:當然啦，客官這間房子很熱門喔，這幾天看這間的人很多
比爾蓋茲:是喔!!!那你什麼時候有空呢，我想越快越好
陳金鋒:好的，我看一下，不然我給你看一下我的行事曆看你哪個時間比較適合?
比爾蓋茲: 恩... 那就"11/05 14:00"好了 陳金鋒:OK , 那我們就那天見囉 ^___^');
INSERT INTO MRMSG(MEM_NO,RTR_NO,MR_MSG) VALUES ('MB00000001','RT00000003','賈伯斯:HI 安安，房仲你好啊!! 林志玲:不好意思，我先去洗澡喔!! 林志玲已離線');
INSERT INTO MRMSG(MEM_NO,RTR_NO,MR_MSG) VALUES ('MB00000001','RT00000012','楊美麗:先生您好，我是xx房仲，我看到你正在找房，我這邊正好有不錯的物件，你要不要參考一下啊!! 賈伯斯:不好意思，我先去洗澡喔!! 賈伯斯已離線');
commit;


-----廠商即時訊息-----
CREATE TABLE MSMSG(
 MEM_NO VARCHAR2(10) NOT NULL,
 SLR_NO VARCHAR2(10) NOT NULL,
 MS_MSG CLOB,
 MS_TIME TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
 CONSTRAINT FK_MSMNO FOREIGN KEY (MEM_NO) REFERENCES MEMBER (MEM_NO),
 CONSTRAINT FK_MSSNO FOREIGN KEY (SLR_NO) REFERENCES SELLER (SLR_NO),
 CONSTRAINT PK_MSMSG PRIMARY KEY (MEM_NO,SLR_NO)
);

INSERT INTO MSMSG(MEM_NO,SLR_NO,MS_MSG) VALUES ('MB00000002','SL00000002','喬丹:ㄟ 明天下午來打籃球阿! 歐德傢俱:好啊，球你帶場你佔，不來算輸 喬丹:槓...又遇到鄉民...');
INSERT INTO MSMSG(MEM_NO,SLR_NO,MS_MSG) VALUES ('MB00000003','SL00000004','彼得吳:你們的家具品質好，而且出貨速度超快的，我才剛下單喝杯茶你們就送來了呢，真是迅速 詩肯柚木:謝謝您的鼓勵，我們最近採用了最新的JAVA技術，讓我們即時掌握需求');
INSERT INTO MSMSG(MEM_NO,SLR_NO,MS_MSG) VALUES ('MB00000004','SL00000004','比爾蓋茲:你好啊，想請問一下為什麼我訂得傢俱還沒送來呢?
詩肯柚木:先生對不起阿，您訂的家具太高級了，我們不敢有任何損傷，因此採用最安全的方式搬運家具，大概在3個月即可看到我們的工人搬到那了，在這期間請敬請等候');
commit;